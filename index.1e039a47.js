!function(){var t={};function e(t,e,r){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return r}function r(t,e){!function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function i(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}}function o(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||i(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s=new WeakSet,l=new WeakSet,u=new WeakSet,c=new WeakSet,f=function(){var t;function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.INITIAL_STATE.map(function(t){return o(t)});!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,n),r(this,s),r(this,l),r(this,u),r(this,c),this.status=n.STATUS.idle,this.board=t,this.score=0}return t=[{key:"moveLeft",value:function(){var t=this;this.board=this.board.map(function(r){return e(t,s,h).call(t,r)}),e(this,u,m).call(this)}},{key:"moveRight",value:function(){var t=this;this.board=this.board.map(function(r){return e(t,s,h).call(t,r.reverse()).reverse()}),e(this,u,m).call(this)}},{key:"moveUp",value:function(){var t=this;this.board=e(this,l,d).call(this,this.board).map(function(r){return e(t,s,h).call(t,r)}),this.board=e(this,l,d).call(this,this.board),e(this,u,m).call(this)}},{key:"moveDown",value:function(){var t=this;this.board=e(this,l,d).call(this,this.board).map(function(r){return e(t,s,h).call(t,r.reverse()).reverse()}),this.board=e(this,l,d).call(this,this.board),e(this,u,m).call(this)}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return this.board.flat().includes(2048)?n.STATUS.win:this.board.flat().includes(0)||e(this,c,b).call(this)?this.status:n.STATUS.lose}},{key:"start",value:function(){this.status=n.STATUS.playing,e(this,u,m).call(this),e(this,u,m).call(this)}},{key:"restart",value:function(){this.board=n.INITIAL_STATE.map(function(t){return o(t)}),this.status=n.STATUS.idle,this.score=0,this.start()}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(n.prototype,t),n}();function h(t){t=t.filter(function(t){return t});for(var e=0;e<t.length-1;e++)t[e]===t[e+1]&&(t[e]*=2,t[e+1]=0,this.score+=t[e]);return t.filter(function(t){return t}).concat(Array(f.FIELD_SIZE-t.filter(function(t){return t}).length).fill(0))}function d(t){return t[0].map(function(e,r){return t.map(function(t){return t[r]})})}function m(){var t=this.board.flatMap(function(t,e){return t.map(function(t,r){return 0===t?[e,r]:null}).filter(function(t){return t})});if(t.length>0){var e,r=function(t){if(Array.isArray(t))return t}(e=t[Math.floor(Math.random()*t.length)])||function(t,e){var r,n,a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var i=[],o=!0,s=!1;try{for(a=a.call(t);!(o=(r=a.next()).done)&&(i.push(r.value),2!==i.length);o=!0);}catch(t){s=!0,n=t}finally{try{o||null==a.return||a.return()}finally{if(s)throw n}}return i}}(e,2)||i(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=r[0],a=r[1];this.board[n][a]=.9>Math.random()?2:4}}function b(){for(var t=0;t<this.board.length;t++)for(var e=0;e<this.board[t].length;e++)if(t<this.board.length-1&&this.board[t][e]===this.board[t+1][e]||e<this.board[t].length-1&&this.board[t][e]===this.board[t][e+1])return!0;return!1}n(f,"FIELD_SIZE",4),n(f,"STATUS",{idle:"idle",playing:"playing",win:"win",lose:"lose"}),n(f,"INITIAL_STATE",Array(f.FIELD_SIZE).fill(Array(f.FIELD_SIZE).fill(0)));var y=new(t=f),v=document.querySelectorAll(".field-cell"),S=document.querySelector(".button.start"),g=function(){var t=y.getState();v.forEach(function(e,r){var n=Math.floor(r/4),a=r%4;e.className="field-cell",e.textContent=t[n][a]||"",t[n][a]&&e.classList.add("field-cell--".concat(t[n][a]))});var e=y.getStatus();document.querySelector(".message-win").classList.toggle("hidden","win"!==e),document.querySelector(".message-lose").classList.toggle("hidden","lose"!==e)},p=function(){document.querySelector(".game-score").textContent=y.getScore()};document.querySelector(".game-score").textContent=y.getScore(),document.addEventListener("keydown",function(e){if(y.getStatus()===t.STATUS.playing){switch(e.key){case"ArrowLeft":y.moveLeft();break;case"ArrowRight":y.moveRight();break;case"ArrowUp":y.moveUp();break;case"ArrowDown":y.moveDown()}g(),p()}}),S.addEventListener("click",function(){S.classList.contains("restart")?y.restart():y.start(),g(),p(),document.querySelectorAll(".message-win, .message-lose, .message-start").forEach(function(t){return t.classList.add("hidden")}),S.textContent="Restart",S.className="button restart"})}();
//# sourceMappingURL=index.1e039a47.js.map
